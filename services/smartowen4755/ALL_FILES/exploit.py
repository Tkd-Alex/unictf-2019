from pwn import *

addr = "192.168.1.100"
port = 12397

r = remote(addr, port)
res = r.readuntil('>') #read menu
#print(res)

r.send("3\n") #insert temperature
res = r.readuntil('Celsius')
#print(res)
r.send("1\n")
res = r.readuntil('>')
#print(res)

r.send("5\n") #insert power
res = r.readuntil('Max')
#print(res)
r.send("3\n")
res = r.readuntil('username')
#print(res)
r.send("THIS_IS_THE_USERNAME\n")
res = r.readuntil('password')
#print(res)
r.send("47ThIsIsNotATr0ll55\n")
res = r.readuntil('>')
#print(res)

r.send("6\n") #insert seconds
res = r.readuntil('seconds:')
#print(res)
r.send("1\n")
res = r.readuntil('>')

r.send("7\n") #start
res = r.readuntil('>')

res = res.splitlines()
res = filter(lambda x: 'unictf{' in x, res)
r.send("0\n")
if res:
	print("Flag: "+ res[0])
else:
	print("Flag not Found")
r.close();


#door = 0, temperature > 0 power = 3 seconds = 1
